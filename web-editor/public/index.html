<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Local Jekyll Post Editor</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="app">
    <aside class="sidebar">
      <div class="brand">
        <h2>âœï¸ Story Writer</h2>
        <small>ğŸ“š Create & Share Stories</small>
      </div>
      <div class="sidebar-actions">
        <button id="newBtn" class="btn primary">âœ¨ New Story</button>
      </div>
      <div class="list-wrap">
        <h4>ğŸ“– My Stories</h4>
        <ul id="posts" class="post-list"></ul>
      </div>
    </aside>

    <main class="editor-area">
      <div class="meta-row">
        <div class="meta-field">
          <label>ğŸ“ Story Title</label>
          <input id="title" placeholder="Give your story a fun name!" />
          <div class="field-error" id="error-title"></div>
        </div>
        <div class="meta-field">
          <label>ğŸ“… When did you write it?</label>
          <input id="date" type="date" />
          <div class="field-error" id="error-date"></div>
        </div>
        <div class="meta-field">
          <label>ğŸ‘¤ Your Name</label>
          <input id="author" placeholder="Your awesome name!" list="authorOptions" />
          <datalist id="authorOptions"></datalist>
          <div class="field-error" id="error-author"></div>
        </div>
        <div class="meta-field">
          <label>ğŸ·ï¸ Tags (Subjects)</label>
          <div style="display:flex;gap:6px;align-items:flex-start;position:relative;flex:1;">
            <div id="categoriesDropdown" class="custom-dropdown" style="flex:1;">
              <div id="categoriesButton" class="dropdown-button">Pick tags...</div>
              <div id="categoriesMenu" class="dropdown-menu" style="display:none;">
                <div id="categoriesList" class="categories-list"></div>
                <div style="border-top:3px solid #4ecdc4;padding:8px;display:flex;gap:6px;">
                  <input id="categoriesNewInput" placeholder="New tag" style="flex:1;padding:8px;border:2px solid #4ecdc4;border-radius:8px;font-size:13px;font-family:inherit;" />
                  <button id="categoriesNewBtn" class="btn" type="button" style="white-space:nowrap;padding:6px 10px;">Add</button>
                </div>
              </div>
            </div>
          </div>
          <div class="field-error" id="error-categories"></div>
        </div>
      </div>

      <div class="toolbar" role="toolbar" aria-label="Story formatting">
        <button class="btn" data-action="h1">ğŸ“Œ Title</button>
        <button class="btn" data-action="bold"><strong>Bold</strong></button>
        <button class="btn" data-action="italic"><em>Italic</em></button>
        <button class="btn" data-action="link">ğŸ”— Link</button>
        <button class="btn" data-action="image">ğŸ–¼ï¸ Picture</button>
        <button class="btn" data-action="code">ğŸ’» Code</button>
        <button class="btn" id="undoBtn">â†©ï¸ Undo</button>
        <button class="btn" id="redoBtn">â†ªï¸ Redo</button>
        <button class="btn" id="togglePreview">ğŸ‘€ Preview</button>
        <div class="spacer"></div>
        <button class="btn primary" id="saveBtn">ğŸ’¾ Save</button>

        <button class="btn danger" id="deleteBtn">ğŸ—‘ï¸ Delete</button>
        <button class="btn" id="renameBtn">âœï¸ Rename</button>
      </div>

      <div class="split-area">
        <textarea id="content" class="editor" spellcheck="false"></textarea>
        <div id="previewArea" class="previewArea"></div>
        <div class="resizer" id="resizer" title="Drag to resize"></div>
      </div>

      <div id="metaPreview" class="meta-preview">
        <div>ğŸ“„ Filename: <code id="previewFilename">(none)</code></div>
        <div>ğŸ–¼ï¸ Picture: <code id="previewImagePath">(none)</code></div>
        <div id="draftStatus" class="draft-status">ğŸ“ Draft saved: <span id="draftTime">never</span> <button id="restoreDraftBtn" class="btn">Restore</button></div>
      </div>

      <!-- Inline status indicator -->
      <div id="statusIndicator" class="status-indicator" aria-live="polite" aria-atomic="true"></div>

    </main>
  </div>

  <!-- Non-blocking modal for unsaved-changes confirmation -->
  <div id="confirmModal" class="modal" aria-hidden="true">
    <div class="modal-panel">
      <h3>âš ï¸ Hold on!</h3>
      <p>You have changes that aren't saved yet. What do you want to do?</p>
      <div class="modal-actions">
        <button id="modalSave" class="btn primary">ğŸ’¾ Save & Continue</button>
        <button id="modalDiscard" class="btn">ğŸš« Don't Save</button>
        <button id="modalCancel" class="btn">ğŸ”„ Keep Editing</button>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="/app.js"></script>
</body>
</html>

